(function(t){function e(e){for(var r,i,s=e[0],c=e[1],u=e[2],d=0,g=[];d<s.length;d++)i=s[d],a[i]&&g.push(a[i][0]),a[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(g.length)g.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==a[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var r={},a={app:0},o=[];function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=r,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/engine/eb_backend/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var u=0;u<s.length;u++)e(s[u]);var l=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"2b04":function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".dummy-tag{display:none}.js-sortable-handle,.savesort-div{text-align:right}",""])},"2fde":function(t,e,n){var r=n("fe9d");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("a298a9f2",r,!0,{sourceMap:!1,shadowMode:!1})},"35a5":function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".dummy-tag{display:none}",""])},"56d7":function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"debug",function(){return W}),n.d(r,"extconf",function(){return X}),n.d(r,"counter",function(){return Y}),n.d(r,"csrfToken",function(){return Z}),n.d(r,"liveApiUrl",function(){return tt});var a={};n.r(a),n.d(a,"mutateCounter",function(){return nt});var o={};n.r(o),n.d(o,"allTags",function(){return ot}),n.d(o,"version",function(){return it}),n.d(o,"getTagsForType",function(){return st});var i={};n.r(i),n.d(i,"fetchTagsForType",function(){return lt}),n.d(i,"getTagsForString",function(){return dt}),n.d(i,"setTagsForRecord",function(){return gt}),n.d(i,"getTagsForRecord",function(){return ft});var s={};n.r(s),n.d(s,"setTagsForType",function(){return pt}),n.d(s,"incVersion",function(){return ht});n("ac4d"),n("8a81"),n("ac6a");var c=n("bd86"),u=(n("7f7f"),n("cebc")),l=(n("a481"),n("5df3"),n("1c4c"),n("cadf"),n("551c"),n("f751"),n("097d"),n("a026")),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"eb-backend"},[n("router-view")],1)},g=[],f=Object(c["a"])({name:"App",components:{},methods:{},computed:{},mounted:function(){this.$router.push({name:this.$parent.tagName})}},"methods",{go:function(t){console.log("#logGO",t),this.$router.push(t)}}),p=f,h=(n("5c0b"),n("2877")),b=Object(h["a"])(p,d,g,!1,null,null,null),v=b.exports,m=(n("472d"),n("8c4f")),T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t.loading?[n("i",{staticClass:"fa fa-spin fa-spinner"})]:[n("vue-tags-input",{ref:"taginput",attrs:{tags:t.tags,"autocomplete-items":t.autocompleteItems,"add-only-from-autocomplete":!0,"autocomplete-min-length":1,placeholder:"","add-on-key":[13]},on:{"tags-changed":function(e){return t.tags=e},"before-adding-tag":function(e){return t.checkAddedTag(e,t._self)}},model:{value:t.tag,callback:function(e){t.tag=e},expression:"tag"}}),t.record?n("button",{staticClass:"btn btn-xs btn-default",on:{click:function(e){return t.saveTags()}}},[n("i",{staticClass:"fa fa-check"})]):t._e(),t.record?n("button",{staticClass:"btn btn-xs btn-default",on:{click:function(e){return t.$parent.go("/view")}}},[n("i",{staticClass:"fa fa-times"})]):t._e()]],2)},y=[],_=(n("28a5"),n("75fc")),x=n("c7a0"),w=n.n(x),S=(n("6b54"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-notification",{attrs:{type:t.data.class,closable:!0},on:{close:function(e){return t.$parent.close()}}},[t._v("\n    "+t._s(t.data.text)+"\n")])}),$=[],F={props:{data:{type:Object,required:!0}}},j=F,k=(n("c97e"),Object(h["a"])(j,S,$,!1,null,null,null)),O=(k.exports,n("b17e"),n("b17e")),C={name:"TagEditor",data:function(){return{loading:!0,types:[],tag:"",record:null,tags:[],inputFieldId:"",initialTagString:""}},components:{VueTagsInput:w.a},methods:{checkAddedTag:function(t,e){""==e.tag?e.saveTags():t.addTag()},saveTags:function(){var t=this;this.loading=!0,this.$store.dispatch("tags/setTagsForRecord",{record:this.record,tag_string:this.tagString}).then(function(e){t.loading=!1,t.$parent.go("/view")}).catch(function(e){t.loading=!1})},getTagsForType:function(t){return this.$store.getters["tags/getTagsForType"](t)},fetchTypes:function(){var t=this;O.map(function(e){null===t.getTagsForType(e)&&t.$store.dispatch("tags/fetchTagsForType",e).then(function(n){console.log("#log save",{type:e,tags:n}),t.$store.commit("tags/setTagsForType",{type:e,tags:n}),t.$store.commit("tags/incVersion")}).catch(function(t){})})(this.types)},getTagsForTagString:function(t){var e=this;this.$store.dispatch("tags/getTagsForString",t).then(function(t){console.log("#tags got",t),e.tags=t,e.loading=!1}).catch(function(t){})},getTagsForRecord:function(t){var e=this;this.$store.dispatch("tags/getTagsForRecord",t).then(function(t){console.log("#tags got",t),e.tags=t,e.loading=!1}).catch(function(t){})},readInitialValue:function(){this.inputField=document.getElementById(this.inputFieldId),this.initialTagString=this.inputField.getAttribute("value"),this.initialTagString&&this.initialTagString.length>1?this.getTagsForTagString(this.initialTagString):this.loading=!1},updateInputField:function(t){this.inputField&&this.inputField.setAttribute("value",t)}},watch:{tagString:function(t,e){this.updateInputField(t||"#")}},computed:{version:function(){return this.$store.getters["tags/version"]},tagString:function(){return O.pipe(O.map(function(t){return"#"+t.key}),O.join(" "))(this.tags)},availableTags:function(){var t=this;this.version;return O.pipe(O.map(function(e){var n=t.getTagsForType(e);return null===n?[]:n}),O.flatten())(this.types)},filteredItems:function(){var t=this;return this.availableTags.filter(function(e){return-1!==e.text.toLowerCase().indexOf(t.tag.toLowerCase())})},autocompleteItems:function(){return Object(_["a"])(this.filteredItems)}},created:function(){var t=this;this.$root.attributes.types&&(this.types=this.$root.attributes.types.split(","),this.fetchTypes()),this.$root.attributes.ref_id&&(this.inputFieldId=this.$root.attributes.ref_id,this.readInitialValue()),this.$root.attributes.record&&(this.record=this.$root.attributes.record,this.getTagsForRecord(this.record)),setTimeout(function(){console.log("#log 1533",t.$refs),t.$refs.taginput.$refs.newTagInput.focus()},500)}},A=C,M=(n("cf8d"),Object(h["a"])(A,T,y,!1,null,null,null)),I=M.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tag-viewer"},[t.loading?[n("i",{staticClass:"fa fa-spin fa-spinner"})]:t._e(),n("div",[t._l(t.tags,function(e){return n("span",{key:e.key,staticClass:"ti-tag",class:e.classes},[t._v(t._s(e.text))])}),t.editable?n("button",{staticClass:"btn btn-xs btn-default",on:{click:function(e){return t.toggleEdit()}}},[n("i",{staticClass:"fa fa-pencil"})]):t._e()],2)],2)},P=[],R={name:"TagViewer",data:function(){return{tags:[],loading:!0,editable:!1,initialTagString:"aa"}},components:{},methods:{toggleEdit:function(){this.$parent.go("/edit")},getTagsForTagString:function(t){var e=this;this.$store.dispatch("tags/getTagsForString",t).then(function(t){console.log("#tags got",t),e.tags=t,e.loading=!1}).catch(function(t){})},getTagsForRecord:function(t){var e=this;this.$store.dispatch("tags/getTagsForRecord",t).then(function(t){console.log("#tags got",t),e.tags=t,e.loading=!1}).catch(function(t){})}},computed:{},created:function(){console.log("#log 9900",this.$root.attributes),this.$root.attributes.record?(this.record=this.$root.attributes.record,this.getTagsForRecord(this.record),this.$root.attributes.editable&&(this.editable=!0)):(this.initialTagString=this.$root.attributes.tagids,this.getTagsForTagString(this.initialTagString))}},U=R,N=(n("df05"),Object(h["a"])(U,E,P,!1,null,null,null)),V=N.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[[t.dirty?n("div",{staticClass:"savesort-div"},[n("div",[t._v(" ")]),t._m(0),n("div",[t._v(" ")])]):t._e(),n("input",{directives:[{name:"model",rawName:"v-model",value:t.idString,expression:"idString"}],attrs:{type:"hidden",name:t.name},domProps:{value:t.idString},on:{input:function(e){e.target.composing||(t.idString=e.target.value)}}})]],2)},L=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"btn btn-primary btn-sm",attrs:{type:"submit"}},[n("i",{staticClass:"fa fa-check"}),t._v(" save new sort-order")])}],q=(n("8615"),n("b17e")),z={name:"RowSorter",data:function(){return{idString:"",dirty:!1}},props:{name:{type:String,required:!0}},methods:{saveSorting:function(){this.idString=q.pipe(q.map(function(t){return t.dataset.id}),q.join(","))(Object.values(document.getElementsByClassName("js-sortable-tr")))},startSorting:function(){var t=this;sortable(".js-sortable",{items:"tr.js-sortable-tr",placeholder:'<tr><td colspan="10"><span class="center">The row will appear here</span></td></tr>',forcePlaceholderSize:!1,handle:".js-sortable-handle"}),sortable(".js-sortable")[0].addEventListener("sortupdate",function(e){t.saveSorting(),t.dirty=!0})}},watch:{},computed:{},mounted:function(){this.startSorting()}},B=z,J=(n("bb49"),Object(h["a"])(B,G,L,!1,null,null,null)),D=J.exports,H=function(t){return new m["a"]({linkActiveClass:"is-active",mode:"abstract",routes:[{path:"/edit",component:I,name:"eb-tag-editor"},{path:"/view",component:V,name:"eb-tag-viewer"},{path:"/rowsorter",component:D,name:"eb-row-sorter",props:t}]})},K=H,Q=n("2f62"),W=function(t){return t.debug},X=function(t){return t.extconf},Y=function(t){return t.counter},Z=function(t){return t.extconf.csrfToken},tt=function(t){return t.extconf.liveApiUrl},et=n("63e0"),nt=function(t,e){t.counter=t.counter+e},rt=n("9fdd"),at={debug:!0,counter:0,extconf:window.vueAppConf},ot=function(t){return t.allTags},it=function(t){return t.version},st=function(t){return function(e){var n=t.allTags[e];return n||null}},ct=n("bc3a"),ut=n.n(ct),lt=(n("b17e"),function(t,e){t.commit;var n=t.rootGetters;return console.log("#log getTagsForType",e,n["liveApiUrl"]),new Promise(function(t,r){ut.a.get(n["liveApiUrl"]+"/get_tags_for_types?types="+e).then(function(n){t(n.data.payload[e])}).catch(function(t){console.error(t),r(t.response)})})}),dt=function(t,e){t.commit;var n=t.rootGetters;return console.log("#log getTagsForString",e,n["liveApiUrl"]),new Promise(function(t,r){ut.a.post(n["liveApiUrl"]+"/get_tags_for_string",{tag_string:e}).then(function(e){t(e.data.payload)}).catch(function(t){console.error(t),r(t.response)})})},gt=function(t,e){t.commit;var n=t.rootGetters,r=e.record,a=e.tag_string;return new Promise(function(t,e){ut.a.post(n["liveApiUrl"]+"/set_tags_for_record/"+r,{tag_string:a}).then(function(e){t(e.data.payload)}).catch(function(t){console.error(t),e(t.response)})})},ft=function(t,e){t.commit;var n=t.rootGetters;return console.log("#log getTagsForRecord",e,n["liveApiUrl"]),new Promise(function(t,r){ut.a.get(n["liveApiUrl"]+"/get_tags_for_record/"+e).then(function(e){t(e.data.payload)}).catch(function(t){console.error(t),r(t.response)})})},pt=function(t,e){var n=e.type,r=e.tags;t.allTags[n]=r},ht=function(t){return t.version++},bt={allTags:{},version:0},vt={namespaced:!0,state:function(){return rt["a"](bt)},getters:o,actions:i,mutations:s};l["default"].use(Q["a"]);var mt=new Q["a"].Store({state:rt["a"](at),getters:r,actions:et,mutations:a,modules:{tags:vt},strict:!0}),Tt=mt;n.d(e,"camelize",function(){return $t});var yt=n("b17e");l["default"].config.productionTip=!1,l["default"].use(m["a"]);var _t=".vueapp-eb_backend",xt=Array.from(document.querySelectorAll(_t)),wt=[],St=/-(\w)/g,$t=function(t){return t.replace(St,function(t,e){return e?e.toUpperCase():""})};if(xt.length>0)for(var Ft=0,jt=xt;Ft<jt.length;Ft++){var kt=jt[Ft],Ot=yt.reduce(function(t,e){return Object(u["a"])({},t,Object(c["a"])({},$t(e.name),e.value))},{})(kt.attributes),Ct=[],At=!0,Mt=!1,It=void 0;try{for(var Et,Pt=kt.children[Symbol.iterator]();!(At=(Et=Pt.next()).done);At=!0){var Rt=Et.value;Ct.push(yt.reduce(function(t,e){return Object(u["a"])({},t,Object(c["a"])({},e.name,e.value))},{})(Rt.attributes))}}catch(Nt){Mt=!0,It=Nt}finally{try{At||null==Pt.return||Pt.return()}finally{if(Mt)throw It}}Ot.childNodes=Ct;var Ut=new l["default"]({render:function(t){return t(v)},el:kt,data:{tagName:null,attributes:{}},beforeMount:function(){this.attributes=yt.reduce(function(t,e){return Object(u["a"])({},t,Object(c["a"])({},e.name,e.value))},{})(this.$el.attributes),this.tagName=this.$el.tagName.toLowerCase()},router:K(Ot),store:Tt});wt.push(Ut)}},"5c0b":function(t,e,n){"use strict";var r=n("e959"),a=n.n(r);a.a},"63e0":function(t,e){},a33e:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".eb-backend .ti-item,.eb-backend .ti-tag{color:#000!important}.eb-backend .ti-item.ti-selected-item,.eb-backend .ti-tag.ti-selected-item{border:1px solid #000}.eb-backend .ti-item{border:1px solid transparent}",""])},a845:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".tag-viewer span.ti-tag{background:#5c6bc0;color:#black;border-radius:2px;display:inline-block;padding:3px 5px;margin:2px;font-size:.85em}",""])},bb49:function(t,e,n){"use strict";var r=n("feff"),a=n.n(r);a.a},c97e:function(t,e,n){"use strict";var r=n("2fde"),a=n.n(r);a.a},cf8d:function(t,e,n){"use strict";var r=n("d90d"),a=n.n(r);a.a},d90d:function(t,e,n){var r=n("35a5");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("32b6c932",r,!0,{sourceMap:!1,shadowMode:!1})},df05:function(t,e,n){"use strict";var r=n("e937"),a=n.n(r);a.a},e937:function(t,e,n){var r=n("a845");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("b0175af2",r,!0,{sourceMap:!1,shadowMode:!1})},e959:function(t,e,n){var r=n("a33e");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("6f19147e",r,!0,{sourceMap:!1,shadowMode:!1})},fe9d:function(t,e,n){e=t.exports=n("2350")(!1),e.push([t.i,".modal button.delete{height:40px;max-height:40px;max-width:40px;min-height:40px;min-width:40px;width:40px}",""])},feff:function(t,e,n){var r=n("2b04");"string"===typeof r&&(r=[[t.i,r,""]]),r.locals&&(t.exports=r.locals);var a=n("499e").default;a("56a5be27",r,!0,{sourceMap:!1,shadowMode:!1})}});
//# sourceMappingURL=app.5b39c3d3.js.map